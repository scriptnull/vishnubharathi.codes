<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="I came across “Middlewares” for writing HTTP servers originally in the Node.js ecosystem. There is this beautiful library called express which sparked the joy of middleware in me. In case you haven’t">
<meta property="og:type" content="article">
<meta property="og:title" content="Exploring Middlewares in Go">
<meta property="og:url" content="https://vishnubharathi.codes/blog/exploring-middlewares-in-go/index.html">
<meta property="og:site_name" content="Vishnu Bharathi">
<meta property="og:description" content="I came across “Middlewares” for writing HTTP servers originally in the Node.js ecosystem. There is this beautiful library called express which sparked the joy of middleware in me. In case you haven’t">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2024-05-20T18:40:08.000Z">
<meta property="article:modified_time" content="2025-01-12T11:15:30.451Z">
<meta property="article:author" content="Vishnu Bharathi">
<meta property="article:tag" content="go">
<meta name="twitter:card" content="summary">
    
    
        
          
              <link rel="shortcut icon" href="https://www.gravatar.com/avatar/261fb0f50b7dea501c807ac01f242343?s=16">
          
        
        
          
            <link rel="icon" type="image/png" href="https://www.gravatar.com/avatar/261fb0f50b7dea501c807ac01f242343?s=192" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="https://www.gravatar.com/avatar/261fb0f50b7dea501c807ac01f242343?s=180">
          
        
    
    <!-- title -->
    <title>Exploring Middlewares in Go</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
      
<link rel="stylesheet" href="/css/rtl.css">

    
    <!-- rss -->
    
    
<meta name="generator" content="Hexo 5.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Blog</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/blog/a-silly-mistake-that-i-made-with-io.teereader/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/blog/rough-notes-on-google-cloud-networking/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://vishnubharathi.codes/blog/exploring-middlewares-in-go/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://vishnubharathi.codes/blog/exploring-middlewares-in-go/&text=Exploring Middlewares in Go"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://vishnubharathi.codes/blog/exploring-middlewares-in-go/&title=Exploring Middlewares in Go"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://vishnubharathi.codes/blog/exploring-middlewares-in-go/&is_video=false&description=Exploring Middlewares in Go"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Exploring Middlewares in Go&body=Check out this article: https://vishnubharathi.codes/blog/exploring-middlewares-in-go/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://vishnubharathi.codes/blog/exploring-middlewares-in-go/&title=Exploring Middlewares in Go"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://vishnubharathi.codes/blog/exploring-middlewares-in-go/&title=Exploring Middlewares in Go"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://vishnubharathi.codes/blog/exploring-middlewares-in-go/&title=Exploring Middlewares in Go"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://vishnubharathi.codes/blog/exploring-middlewares-in-go/&title=Exploring Middlewares in Go"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://vishnubharathi.codes/blog/exploring-middlewares-in-go/&name=Exploring Middlewares in Go&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://vishnubharathi.codes/blog/exploring-middlewares-in-go/&t=Exploring Middlewares in Go"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Problem"><span class="toc-number">1.</span> <span class="toc-text">Problem</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Solution"><span class="toc-number">2.</span> <span class="toc-text">Solution</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Without-Middleware"><span class="toc-number">2.1.</span> <span class="toc-text">Without Middleware</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Basic-Middleware"><span class="toc-number">2.2.</span> <span class="toc-text">Basic Middleware</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Using-http-HandleFunc"><span class="toc-number">2.3.</span> <span class="toc-text">Using http.HandleFunc</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Enter-http-Handler"><span class="toc-number">2.4.</span> <span class="toc-text">Enter http.Handler</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#http-HandlerFunc-to-http-Handler"><span class="toc-number">2.5.</span> <span class="toc-text">http.HandlerFunc to http.Handler</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Standard-library-Middlewares"><span class="toc-number">3.</span> <span class="toc-text">Standard library Middlewares</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#AllowQuerySemicolons"><span class="toc-number">3.1.</span> <span class="toc-text">AllowQuerySemicolons</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MaxBytesHandler"><span class="toc-number">3.2.</span> <span class="toc-text">MaxBytesHandler</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#StripPrefix"><span class="toc-number">3.3.</span> <span class="toc-text">StripPrefix</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#TimeoutHandler"><span class="toc-number">3.4.</span> <span class="toc-text">TimeoutHandler</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Third-party-Middlewares"><span class="toc-number">4.</span> <span class="toc-text">Third-party Middlewares</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Communicate"><span class="toc-number">5.</span> <span class="toc-text">Communicate</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Chain"><span class="toc-number">6.</span> <span class="toc-text">Chain</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Closing-Thoughts"><span class="toc-number">7.</span> <span class="toc-text">Closing Thoughts</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        Exploring Middlewares in Go
    </h1>



    <div class="meta">
      
    <div class="postdate">
      
        <time datetime="2024-05-20T18:40:08.000Z" itemprop="datePublished">2024-05-21</time>
        
      
    </div>


      

      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link-link" href="/tags/go/" rel="tag">go</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <p>I came across “Middlewares” for writing HTTP servers originally in the Node.js ecosystem. There is this beautiful library called <a target="_blank" rel="noopener" href="https://expressjs.com/">express</a> which sparked the joy of middleware in me. In case you haven’t heard of middleware before, I think you should read <a target="_blank" rel="noopener" href="https://expressjs.com/en/guide/using-middleware.html">this beautiful page</a> from expressjs documentation to get a taste of them. (I genuinely feel that it is the best possible introduction for middleware, hence opening up the post with it)</p>
<p>With enough JavaScript for the day, we will jump into Go now. 😅</p>
<p>My goal for this post is to understand how to {use, write} middlewares in Go HTTP servers. We will also try to search the internet and surface some Go middlewares that we can add to our day-to-day toolkit.</p>
<h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>Let us take a simple problem and work our way upwards. Here is the problem statement:</p>
<p>Write an HTTP server that contains multiple routes. When a request is made to a route, print a log line at the start and the end of the request. Something like</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">2024&#x2F;05&#x2F;21 00:49:32 INFO start method&#x3D;GET path&#x3D;&#x2F;one</span><br><span class="line">2024&#x2F;05&#x2F;21 00:49:32 INFO end method&#x3D;GET path&#x3D;&#x2F;one</span><br><span class="line">2024&#x2F;05&#x2F;21 00:49:34 INFO start method&#x3D;GET path&#x3D;&#x2F;two</span><br><span class="line">2024&#x2F;05&#x2F;21 00:49:34 INFO end method&#x3D;GET path&#x3D;&#x2F;two</span><br></pre></td></tr></table></figure>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><h3 id="Without-Middleware"><a href="#Without-Middleware" class="headerlink" title="Without Middleware"></a>Without Middleware</h3><p>A solution without using middleware would look like</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;log/slog&quot;</span></span><br><span class="line">	<span class="string">&quot;net/http&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	http.HandleFunc(<span class="string">&quot;/one&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(w http.ResponseWriter, r *http.Request)</span></span> &#123;</span><br><span class="line">		slog.Info(<span class="string">&quot;start&quot;</span>, <span class="string">&quot;method&quot;</span>, r.Method, <span class="string">&quot;path&quot;</span>, r.URL.Path)</span><br><span class="line">		<span class="keyword">defer</span> slog.Info(<span class="string">&quot;end&quot;</span>, <span class="string">&quot;method&quot;</span>, r.Method, <span class="string">&quot;path&quot;</span>, r.URL.Path)</span><br><span class="line"></span><br><span class="line">		fmt.Fprintln(w, <span class="string">&quot;this is one&quot;</span>)</span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">	http.HandleFunc(<span class="string">&quot;/two&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(w http.ResponseWriter, r *http.Request)</span></span> &#123;</span><br><span class="line">		slog.Info(<span class="string">&quot;start&quot;</span>, <span class="string">&quot;method&quot;</span>, r.Method, <span class="string">&quot;path&quot;</span>, r.URL.Path)</span><br><span class="line">		<span class="keyword">defer</span> slog.Info(<span class="string">&quot;end&quot;</span>, <span class="string">&quot;method&quot;</span>, r.Method, <span class="string">&quot;path&quot;</span>, r.URL.Path)</span><br><span class="line"></span><br><span class="line">		fmt.Fprintln(w, <span class="string">&quot;this is two&quot;</span>)</span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">	http.ListenAndServe(<span class="string">&quot;:3000&quot;</span>, <span class="literal">nil</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>How do we avoid copy-pasting those two lines to every HTTP handler function? Middlewares for the win!</p>
<h3 id="Basic-Middleware"><a href="#Basic-Middleware" class="headerlink" title="Basic Middleware"></a>Basic Middleware</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;log/slog&quot;</span></span><br><span class="line">	<span class="string">&quot;net/http&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">logRequest</span><span class="params">(next <span class="keyword">func</span>(http.ResponseWriter, *http.Request)</span>) <span class="title">func</span><span class="params">(http.ResponseWriter, *http.Request)</span></span> &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="function"><span class="keyword">func</span><span class="params">(w http.ResponseWriter, r *http.Request)</span></span> &#123;</span><br><span class="line">		slog.Info(<span class="string">&quot;start&quot;</span>, <span class="string">&quot;method&quot;</span>, r.Method, <span class="string">&quot;path&quot;</span>, r.URL.Path)</span><br><span class="line">		<span class="keyword">defer</span> slog.Info(<span class="string">&quot;end&quot;</span>, <span class="string">&quot;method&quot;</span>, r.Method, <span class="string">&quot;path&quot;</span>, r.URL.Path)</span><br><span class="line"></span><br><span class="line">		next(w, r)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">oneHandler</span><span class="params">(w http.ResponseWriter, r *http.Request)</span></span> &#123;</span><br><span class="line">	fmt.Fprintln(w, <span class="string">&quot;this is one&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">twoHander</span><span class="params">(w http.ResponseWriter, r *http.Request)</span></span> &#123;</span><br><span class="line">	fmt.Fprintln(w, <span class="string">&quot;this is two&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	http.HandleFunc(<span class="string">&quot;/one&quot;</span>, logRequest(oneHandler))</span><br><span class="line">	http.HandleFunc(<span class="string">&quot;/two&quot;</span>, logRequest(twoHander))</span><br><span class="line"></span><br><span class="line">	http.ListenAndServe(<span class="string">&quot;:3000&quot;</span>, <span class="literal">nil</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Using-http-HandleFunc"><a href="#Using-http-HandleFunc" class="headerlink" title="Using http.HandleFunc"></a>Using http.HandleFunc</h3><p>We are not done yet! There is still room for improvement. Notice how big the method signature for <code>logRequest</code> is! we can start from there. I remember a standard library type called <code>http.HandlerFunc</code> which could be used in the place of <code>func(ResponseWriter, *Request)</code>. If we start using it, our middleware looks like this.</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">logRequest</span><span class="params">(next http.HandlerFunc)</span> <span class="title">http</span>.<span class="title">HandlerFunc</span></span> &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="function"><span class="keyword">func</span><span class="params">(w http.ResponseWriter, r *http.Request)</span></span> &#123;</span><br><span class="line">		slog.Info(<span class="string">&quot;start&quot;</span>, <span class="string">&quot;method&quot;</span>, r.Method, <span class="string">&quot;path&quot;</span>, r.URL.Path)</span><br><span class="line">		<span class="keyword">defer</span> slog.Info(<span class="string">&quot;end&quot;</span>, <span class="string">&quot;method&quot;</span>, r.Method, <span class="string">&quot;path&quot;</span>, r.URL.Path)</span><br><span class="line"></span><br><span class="line">		next(w, r)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>While browsing through the Go docs, I noticed that <code>http.HandleFunc</code> has the below method signature.</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">HandleFunc</span><span class="params">(pattern <span class="keyword">string</span>, handler <span class="keyword">func</span>(ResponseWriter, *Request)</span>)</span></span><br></pre></td></tr></table></figure>
<p>That raised a question in me. Why don’t they use <code>func HandleFunc(pattern string, handler http.HandlerFunc)</code> instead? I thought <code>http.HandlerFunc</code> is an alias type for <code>func(ResponseWriter, *Request)</code>. Digging through the standard library source code had the answer. It seems like it is just not a simple alias, but more than that. Copy pasting the implementation of <code>http.HanderFunc</code> for you straight out of Go source :D</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// The HandlerFunc type is an adapter to allow the use of</span></span><br><span class="line"><span class="comment">// ordinary functions as HTTP handlers. If f is a function</span></span><br><span class="line"><span class="comment">// with the appropriate signature, HandlerFunc(f) is a</span></span><br><span class="line"><span class="comment">// [Handler] that calls f.</span></span><br><span class="line"><span class="keyword">type</span> HandlerFunc <span class="function"><span class="keyword">func</span><span class="params">(ResponseWriter, *Request)</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ServeHTTP calls f(w, r).</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(f HandlerFunc)</span> <span class="title">ServeHTTP</span><span class="params">(w ResponseWriter, r *Request)</span></span> &#123;</span><br><span class="line">	f(w, r)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>oh wow, so <code>http.HandlerFunc</code> is a <code>func(ResponseWriter, *Request)</code> which implements the <a target="_blank" rel="noopener" href="https://pkg.go.dev/net/http#Handler">http.Handler</a> interface.</p>
<h3 id="Enter-http-Handler"><a href="#Enter-http-Handler" class="headerlink" title="Enter http.Handler"></a>Enter http.Handler</h3><p>Why would we need an adapter like <code>http.HandlerFunc</code> that implements the <code>http.Handler</code> interface. To understand, let us take a look at the interface definition.</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Handler <span class="keyword">interface</span> &#123;</span><br><span class="line">	ServeHTTP(ResponseWriter, *Request)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>and also read through the <a target="_blank" rel="noopener" href="https://pkg.go.dev/net/http#Handler">http.Handler documentation</a>. At first, it didn’t solve my doubt, but then I discovered <a target="_blank" rel="noopener" href="https://pkg.go.dev/net/http#example-Handle">this beautiful example</a> in the docs. Copy pasting the example from the docs here for you to have a quick look.</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;log&quot;</span></span><br><span class="line">	<span class="string">&quot;net/http&quot;</span></span><br><span class="line">	<span class="string">&quot;sync&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> countHandler <span class="keyword">struct</span> &#123;</span><br><span class="line">	mu sync.Mutex <span class="comment">// guards n</span></span><br><span class="line">	n  <span class="keyword">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(h *countHandler)</span> <span class="title">ServeHTTP</span><span class="params">(w http.ResponseWriter, r *http.Request)</span></span> &#123;</span><br><span class="line">	h.mu.Lock()</span><br><span class="line">	<span class="keyword">defer</span> h.mu.Unlock()</span><br><span class="line">	h.n++</span><br><span class="line">	fmt.Fprintf(w, <span class="string">&quot;count is %d\n&quot;</span>, h.n)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	http.Handle(<span class="string">&quot;/count&quot;</span>, <span class="built_in">new</span>(countHandler))</span><br><span class="line">	log.Fatal(http.ListenAndServe(<span class="string">&quot;:8080&quot;</span>, <span class="literal">nil</span>))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>wow, did you get it? Sometimes your handler is more than just a <code>func(http.ResponseWriter, *http.Request)</code>. It could be a struct that contains data that could be used in your request logic. Like in the above case, <code>countHandler</code> maintains a counter protected by a mutex. Each and every request to <code>/count</code> would increment the counter atomically.</p>
<p>For simple routes, which are just a bunch of instructions we could use <code>http.HandleFunc</code>. But once your handler gets complex, like having to maintain data that is common to all requests of the handler, then move upward and go for <code>http.Handle</code>.</p>
<p>woah, this just cleared my long-standing doubt about “when to use <code>http.Handle</code> and <code>http.HandleFunc</code>?”</p>
<p>It is getting a bit clearer now on why the <code>http.Handler</code> interface is needed. With two ways of defining a HTTP handler: one being to write a <code>func(http.ResponseWriter, *http.Request)</code> and pass it to <code>http.HandleFunc</code> and another being to write a struct with the necessary logic and pass it down to <code>http.Handle</code> function, the standard libary needs a common ground in which all its methods can operate on both the types of handlers. Hence an interface.</p>
<h3 id="http-HandlerFunc-to-http-Handler"><a href="#http-HandlerFunc-to-http-Handler" class="headerlink" title="http.HandlerFunc to http.Handler"></a>http.HandlerFunc to http.Handler</h3><p>Now that it is evident that a Go programmer could choose between using <code>http.Handle</code> or <code>http.HandleFunc</code> to serve their handlers, it is necessary that any HTTP middleware should work for both of those use cases. With the current approach to our solution, we will only support middlewares that are input to <code>http.HandleFunc</code>. Hence moving our middleware to use <code>http.Handler</code> interface, that way we could accommodate both types of handlers.</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;log/slog&quot;</span></span><br><span class="line">	<span class="string">&quot;net/http&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">logRequest</span><span class="params">(next http.Handler)</span> <span class="title">http</span>.<span class="title">Handler</span></span> &#123;</span><br><span class="line">	<span class="keyword">return</span> http.HandlerFunc(<span class="function"><span class="keyword">func</span><span class="params">(w http.ResponseWriter, r *http.Request)</span></span> &#123;</span><br><span class="line">		slog.Info(<span class="string">&quot;start&quot;</span>, <span class="string">&quot;method&quot;</span>, r.Method, <span class="string">&quot;path&quot;</span>, r.URL.Path)</span><br><span class="line">		<span class="keyword">defer</span> slog.Info(<span class="string">&quot;end&quot;</span>, <span class="string">&quot;method&quot;</span>, r.Method, <span class="string">&quot;path&quot;</span>, r.URL.Path)</span><br><span class="line"></span><br><span class="line">		next.ServeHTTP(w, r)</span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">oneHandler</span><span class="params">(w http.ResponseWriter, r *http.Request)</span></span> &#123;</span><br><span class="line">	fmt.Fprintln(w, <span class="string">&quot;this is one&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">twoHander</span><span class="params">(w http.ResponseWriter, r *http.Request)</span></span> &#123;</span><br><span class="line">	fmt.Fprintln(w, <span class="string">&quot;this is two&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	http.Handle(<span class="string">&quot;/one&quot;</span>, logRequest(http.HandlerFunc(oneHandler)))</span><br><span class="line">	http.Handle(<span class="string">&quot;/two&quot;</span>, logRequest(http.HandlerFunc(twoHander)))</span><br><span class="line"></span><br><span class="line">	http.ListenAndServe(<span class="string">&quot;:3000&quot;</span>, <span class="literal">nil</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Standard-library-Middlewares"><a href="#Standard-library-Middlewares" class="headerlink" title="Standard library Middlewares"></a>Standard library Middlewares</h2><p>The <code>net/http</code> package in the standard library of Go contains middlewares. If you haven’t realized it yet, don’t worry. That is because they don’t advertise those functions as “middleware” (ctrl+f on docs for middleware leaves you with 0 matches :D)</p>
<h3 id="AllowQuerySemicolons"><a href="#AllowQuerySemicolons" class="headerlink" title="AllowQuerySemicolons"></a>AllowQuerySemicolons</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">AllowQuerySemicolons</span><span class="params">(h Handler)</span> <span class="title">Handler</span></span></span><br></pre></td></tr></table></figure>
<p>TIL that we could use semicolons instead of ampersands in query strings (though this style is deprecated by W3C). Read more about it here: <a target="_blank" rel="noopener" href="https://github.com/golang/go/issues/25192">https://github.com/golang/go/issues/25192</a>. This middleware is present in the stdlib for solving that problem by replacing the <code>;</code> with <code>&amp;</code> under the hood. </p>
<h3 id="MaxBytesHandler"><a href="#MaxBytesHandler" class="headerlink" title="MaxBytesHandler"></a>MaxBytesHandler</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">MaxBytesHandler</span><span class="params">(h Handler, n <span class="keyword">int64</span>)</span> <span class="title">Handler</span></span></span><br></pre></td></tr></table></figure>
<p>This could be used to limit the acceptable request body size. Under the hood, it uses <code>MaxBytesReader</code>:</p>
<blockquote>
<p>MaxBytesReader prevents clients from accidentally or maliciously sending a large request and wasting server resources. If possible, it tells the ResponseWriter to close the connection after the limit has been reached.</p>
</blockquote>
<h3 id="StripPrefix"><a href="#StripPrefix" class="headerlink" title="StripPrefix"></a>StripPrefix</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">StripPrefix</span><span class="params">(prefix <span class="keyword">string</span>, h Handler)</span> <span class="title">Handler</span></span></span><br></pre></td></tr></table></figure>
<p>The docs says</p>
<blockquote>
<p>StripPrefix returns a handler that serves HTTP requests by removing the given prefix from the request URL’s Path (and RawPath if set) and invoking the handler h.</p>
</blockquote>
<p>My first impression is how could this be useful. Oh, wait for the blast! Here we go once again with a beautiful copy-paste of an stdlib example.</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;net/http&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">// To serve a directory on disk (/tmp) under an alternate URL</span></span><br><span class="line">	<span class="comment">// path (/tmpfiles/), use StripPrefix to modify the request</span></span><br><span class="line">	<span class="comment">// URL&#x27;s path before the FileServer sees it:</span></span><br><span class="line">	http.Handle(<span class="string">&quot;/tmpfiles/&quot;</span>, http.StripPrefix(<span class="string">&quot;/tmpfiles/&quot;</span>, http.FileServer(http.Dir(<span class="string">&quot;/tmp&quot;</span>))))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="TimeoutHandler"><a href="#TimeoutHandler" class="headerlink" title="TimeoutHandler"></a>TimeoutHandler</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">TimeoutHandler</span><span class="params">(h Handler, dt time.Duration, msg <span class="keyword">string</span>)</span> <span class="title">Handler</span></span></span><br></pre></td></tr></table></figure>
<p>As the name says, it times out the handler if the request is taking more than the given duration.</p>
<h2 id="Third-party-Middlewares"><a href="#Third-party-Middlewares" class="headerlink" title="Third-party Middlewares"></a>Third-party Middlewares</h2><p>I came across this beautiful library called <code>chi</code> which comes loaded up with a bunch of middlewares out of the box: <a target="_blank" rel="noopener" href="https://github.com/go-chi/chi?tab=readme-ov-file#middlewares">https://github.com/go-chi/chi?tab=readme-ov-file#middlewares</a></p>
<p>I would suggest starting with the default chi recommendation:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// A good base middleware stack</span></span><br><span class="line">r.Use(middleware.RequestID)</span><br><span class="line">r.Use(middleware.RealIP)</span><br><span class="line">r.Use(middleware.Logger)</span><br><span class="line">r.Use(middleware.Recoverer)</span><br></pre></td></tr></table></figure>
<p>and then build up the chain. Go explore and catch ‘em all!</p>
<p>(also let me know your favorite middleware if you have one - because I am trying to discover more third-party middlewares in Go)</p>
<h2 id="Communicate"><a href="#Communicate" class="headerlink" title="Communicate"></a>Communicate</h2><p>When writing or using middleware, you may need to pass down a variable that was created by one middleware into another middleware or in the request handler. In the case of JS, we would just mutate the <code>request</code> object directly since it is dynamically typed :D (lol, good old days). In the case of Go, we can’t do that and we will need a way of passing through variables of any type via the available <code>ResponseWriter</code> or <code>Request</code> objects.</p>
<p>I have previously written a whole blog post on the <a href="https://vishnubharathi.codes/blog/context-with-value-pitfall">pitfalls of context.WithValue</a> and when not to use them. And well, this is actually the use-case where you can use them!</p>
<p>A context variable is available to you in all the middlewares and the handlers via the <code>http.Request</code> object. We could use that to store and pass down information. </p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">type</span> RequestKey <span class="keyword">string</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> (</span><br><span class="line">	RequestIDKey RequestKey = <span class="string">&quot;request-id&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">RequestID</span><span class="params">(next http.Handler)</span> <span class="title">http</span>.<span class="title">Handler</span></span> &#123;</span><br><span class="line">	<span class="keyword">return</span> http.HandlerFunc(<span class="function"><span class="keyword">func</span><span class="params">(w http.ResponseWriter, r *http.Request)</span></span> &#123;</span><br><span class="line">		ctx := context.WithValue(r.Context(), RequestIDKey, uuid.New())</span><br><span class="line">		next.ServeHTTP(w, r.WithContext(ctx))</span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">handlerThatUsesRequestID</span><span class="params">(w http.ResponseWriter, r *http.Request)</span></span> &#123;</span><br><span class="line">	reqID, ok := r.Context().Value(RequestIDKey).(uuid.UUID)</span><br><span class="line">	<span class="keyword">if</span> !ok || reqID == uuid.Nil &#123;</span><br><span class="line">		fmt.Fprintln(w, <span class="string">&quot;this a request without requestID&quot;</span>)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Fprintf(w, <span class="string">&quot;request id is %s\n&quot;</span>, reqID)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>You still need to be careful while using <code>context.WithValue</code>. What if you miss calling a middleware, but try to look up the value that it is supposed to set in <code>r.Context</code>? It changes the trajectory of your request during runtime and in the worst case it will lead to runtime panics in your handler. I am wondering if we could somehow catch this kind of stuff during compile time (like maybe by writing a library or perhaps someone already thought about this before - if so, let me know!)</p>
<h2 id="Chain"><a href="#Chain" class="headerlink" title="Chain"></a>Chain</h2><p>You might soon end up having to call multiple middleware for your handlers. In that case, your code would look like:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// middlewares for unauthenticated routes</span></span><br><span class="line">http.Handle(<span class="string">&quot;/&quot;</span>, Logger(RequestID(homeHandler))))</span><br><span class="line"></span><br><span class="line"><span class="comment">// middlewares for authenticated routes</span></span><br><span class="line">http.Handle(<span class="string">&quot;/profile&quot;</span>, Logger(RequestID(BasicAuth(userProfileHandler)))))</span><br></pre></td></tr></table></figure>
<p>We need a way to chain the middleware and store the chain so that we can reuse it between handlers. I recently discovered a library for this, which might help here: <a target="_blank" rel="noopener" href="https://github.com/justinas/alice">https://github.com/justinas/alice</a></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">unAuth := alice.New(Logger, RequestID)</span><br><span class="line">auth := alice.New(Logger, RequestID, BasicAuth)</span><br><span class="line"></span><br><span class="line">http.Handle(<span class="string">&quot;/&quot;</span>, unAuth.Then(homeHandler))</span><br><span class="line">http.Handle(<span class="string">&quot;/profile&quot;</span>, auth.Then(userProfileHandler))</span><br></pre></td></tr></table></figure>
<p>You can also use a routing library like <code>chi</code> where the request middlewares are defined at the router level.</p>
<h2 id="Closing-Thoughts"><a href="#Closing-Thoughts" class="headerlink" title="Closing Thoughts"></a>Closing Thoughts</h2><p>I hope this exploration was useful to you! It definitely made me learn some unexpected things like “when to use http.Handle? when to use http.HandleFunc? ….”. This is also inspiring me to write a small middleware library that I have been thinking about.</p>
<p>~ ~ ~ ~</p>
<p>In an alternate universe, someone declared <code>type Middleware func(Handler) Handler</code> in <code>net/http</code> and (use your imagination).</p>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Blog</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Problem"><span class="toc-number">1.</span> <span class="toc-text">Problem</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Solution"><span class="toc-number">2.</span> <span class="toc-text">Solution</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Without-Middleware"><span class="toc-number">2.1.</span> <span class="toc-text">Without Middleware</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Basic-Middleware"><span class="toc-number">2.2.</span> <span class="toc-text">Basic Middleware</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Using-http-HandleFunc"><span class="toc-number">2.3.</span> <span class="toc-text">Using http.HandleFunc</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Enter-http-Handler"><span class="toc-number">2.4.</span> <span class="toc-text">Enter http.Handler</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#http-HandlerFunc-to-http-Handler"><span class="toc-number">2.5.</span> <span class="toc-text">http.HandlerFunc to http.Handler</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Standard-library-Middlewares"><span class="toc-number">3.</span> <span class="toc-text">Standard library Middlewares</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#AllowQuerySemicolons"><span class="toc-number">3.1.</span> <span class="toc-text">AllowQuerySemicolons</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MaxBytesHandler"><span class="toc-number">3.2.</span> <span class="toc-text">MaxBytesHandler</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#StripPrefix"><span class="toc-number">3.3.</span> <span class="toc-text">StripPrefix</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#TimeoutHandler"><span class="toc-number">3.4.</span> <span class="toc-text">TimeoutHandler</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Third-party-Middlewares"><span class="toc-number">4.</span> <span class="toc-text">Third-party Middlewares</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Communicate"><span class="toc-number">5.</span> <span class="toc-text">Communicate</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Chain"><span class="toc-number">6.</span> <span class="toc-text">Chain</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Closing-Thoughts"><span class="toc-number">7.</span> <span class="toc-text">Closing Thoughts</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://vishnubharathi.codes/blog/exploring-middlewares-in-go/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://vishnubharathi.codes/blog/exploring-middlewares-in-go/&text=Exploring Middlewares in Go"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://vishnubharathi.codes/blog/exploring-middlewares-in-go/&title=Exploring Middlewares in Go"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://vishnubharathi.codes/blog/exploring-middlewares-in-go/&is_video=false&description=Exploring Middlewares in Go"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Exploring Middlewares in Go&body=Check out this article: https://vishnubharathi.codes/blog/exploring-middlewares-in-go/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://vishnubharathi.codes/blog/exploring-middlewares-in-go/&title=Exploring Middlewares in Go"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://vishnubharathi.codes/blog/exploring-middlewares-in-go/&title=Exploring Middlewares in Go"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://vishnubharathi.codes/blog/exploring-middlewares-in-go/&title=Exploring Middlewares in Go"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://vishnubharathi.codes/blog/exploring-middlewares-in-go/&title=Exploring Middlewares in Go"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://vishnubharathi.codes/blog/exploring-middlewares-in-go/&name=Exploring Middlewares in Go&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://vishnubharathi.codes/blog/exploring-middlewares-in-go/&t=Exploring Middlewares in Go"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
<div class="footer-left">
<a rel="license noopener" target="_blank" href="http://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>
</div>
<div class="footer-right">
<nav>
<ul>

    <li><a href="/">Home</a></li>
        
    <li><a href="/archives/">Blog</a></li>
        
    <li><a href="/atom.xml">Feed</a></li>
    <li><a href="http://eepurl.com/gUCSRn" target="_blank" rel="noopener noreferrer">Subscribe</a></li>
    <li><div class="rc-scout" style="height: 24px; width: 24px;"></div></li>
</ul>
</nav>
</div>
</footer>

    </div>
    <!-- styles -->

<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">


<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">


    <!-- jquery -->

<script src="/lib/jquery/jquery.min.js"></script>


<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>

<!-- clipboard -->

  
<script src="/lib/clipboard/clipboard.min.js"></script>

  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Disqus Comments -->

<!-- Recurse Center -->
<script async defer src="https://www.recurse-scout.com/loader.js?t=9c0d969e43d5103ee1c163128e870dc3"></script>
<!-- Cloudflare analytics -->

<script defer src='https://static.cloudflareinsights.com/beacon.min.js' data-cf-beacon='{"token": "3a998e7dd4534719a1186cd0b01043fc"}'></script>


</body>
</html>
